[
  {
    "question": "Provide an analysis of web category duration usage, broke out by client persona classification. Provide the web category usage values in terms of weighted percentages, the sum total of which for any persona grouping should add to 100%. Provide the number of clients as well as the number of days of data that fed into the analysis for each persona.",
    "sql": "select persona, count(distinct guid) as number_of_systems, sum(days) as days, round(100*sum(days * content_creation_photo_edit_creation/total_duration)/sum(days),3) as content_creation_photo_edit_creation, round(100*sum(days * content_creation_video_audio_edit_creation/total_duration)/sum(days),3) as content_creation_video_audio_edit_creation, round(100*sum(days * content_creation_web_design_development/total_duration)/sum(days),3) as content_creation_web_design_development, round(100*sum(days * education/total_duration)/sum(days),3) as education, round(100*sum(days * entertainment_music_audio_streaming/total_duration)/sum(days),3) as entertainment_music_audio_streaming, round(100*sum(days * entertainment_other/total_duration)/sum(days),3) as entertainment_other, round(100*sum(days * entertainment_video_streaming/total_duration)/sum(days),3) as entertainment_video_streaming, round(100*sum(days * finance/total_duration)/sum(days),3) as finance, round(100*sum(days * games_other/total_duration)/sum(days),3) as games_other, round(100*sum(days * games_video_games/total_duration)/sum(days),3) as games_video_games, round(100*sum(days * mail/total_duration)/sum(days),3) as mail, round(100*sum(days * news/total_duration)/sum(days),3) as news, round(100*sum(days * unclassified/total_duration)/sum(days),3) as unclassified, round(100*sum(days * private/total_duration)/sum(days),3) as private, round(100*sum(days * productivity_crm/total_duration)/sum(days),3) as productivity_crm, round(100*sum(days * productivity_other/total_duration)/sum(days),3) as productivity_other, round(100*sum(days * productivity_presentations/total_duration)/sum(days),3) as productivity_presentations, round(100*sum(days * productivity_programming/total_duration)/sum(days),3) as productivity_programming, round(100*sum(days * productivity_project_management/total_duration)/sum(days),3) as productivity_project_management, round(100*sum(days * productivity_spreadsheets/total_duration)/sum(days),3) as productivity_spreadsheets, round(100*sum(days * productivity_word_processing/total_duration)/sum(days),3) as productivity_word_processing, round(100*sum(days * recreation_travel/total_duration)/sum(days),3) as recreation_travel, round(100*sum(days * reference/total_duration)/sum(days),3) as reference, round(100*sum(days * search/total_duration)/sum(days),3) as search, round(100*sum(days * shopping/total_duration)/sum(days),3) as shopping, round(100*sum(days * social_social_network/total_duration)/sum(days),3) as social_social_network, round(100*sum(days * social_communication/total_duration)/sum(days),3) as social_communication, round(100*sum(days * social_communication_live/total_duration)/sum(days),3) as social_communication_live from (select a.guid, a.persona, count(b.*) as days, sum(b.content_creation_photo_edit_creation) as content_creation_photo_edit_creation, sum(b.content_creation_video_audio_edit_creation) as content_creation_video_audio_edit_creation, sum(b.content_creation_web_design_development) as content_creation_web_design_development, sum(b.education) as education, sum(b.entertainment_music_audio_streaming) as entertainment_music_audio_streaming, sum(b.entertainment_other) as entertainment_other, sum(b.entertainment_video_streaming) as entertainment_video_streaming, sum(b.finance) as finance, sum(b.games_other) as games_other, sum(b.games_video_games) as games_video_games, sum(b.mail) as mail, sum(b.news) as news, sum(b.unclassified) as unclassified, sum(b.private) as private, sum(b.productivity_crm) as productivity_crm, sum(b.productivity_other) as productivity_other, sum(b.productivity_presentations) as productivity_presentations, sum(b.productivity_programming) as productivity_programming, sum(b.productivity_project_management) as productivity_project_management, sum(b.productivity_spreadsheets) as productivity_spreadsheets, sum(b.productivity_word_processing) as productivity_word_processing, sum(b.recreation_travel) as recreation_travel, sum(b.reference) as reference, sum(b.search) as search, sum(b.shopping) as shopping, sum(b.social_social_network) as social_social_network, sum(b.social_communication) as social_communication, sum(b.social_communication_live) as social_communication_live, sum(b.content_creation_video_audio_edit_creation + b.content_creation_photo_edit_creation + b.content_creation_web_design_development + b.education + b.entertainment_music_audio_streaming + b.entertainment_other + b.entertainment_video_streaming + b.finance + b.games_other + b.games_video_games + b.mail + b.news + b.unclassified + b.private + b.productivity_crm + b.productivity_other + b.productivity_presentations + b.productivity_programming + b.productivity_project_management + b.productivity_spreadsheets + b.productivity_word_processing + b.recreation_travel + b.reference + b.search + b.shopping + b.social_social_network + b.social_communication + b.social_communication_live) as total_duration from reporting.system_sysinfo_unique_normalized a inner join reporting.system_web_cat_pivot_duration b on a.guid = b.guid group by 1, 2) inn group by persona;",
    "db_id": "dw",
    "mapping": {},
    "join_keys": [],
    "gold_tables": []
  }
]